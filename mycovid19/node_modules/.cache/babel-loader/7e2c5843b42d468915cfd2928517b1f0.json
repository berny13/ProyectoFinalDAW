{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.symbol\");\n\nrequire(\"core-js/modules/es.symbol.description\");\n\nrequire(\"core-js/modules/es.symbol.iterator\");\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.from\");\n\nrequire(\"core-js/modules/es.array.includes\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.array.map\");\n\nrequire(\"core-js/modules/es.array.slice\");\n\nrequire(\"core-js/modules/es.array.splice\");\n\nrequire(\"core-js/modules/es.function.name\");\n\nrequire(\"core-js/modules/es.object.assign\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.reflect.construct\");\n\nrequire(\"core-js/modules/es.reflect.get\");\n\nrequire(\"core-js/modules/es.regexp.constructor\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.regexp.to-string\");\n\nrequire(\"core-js/modules/es.string.includes\");\n\nrequire(\"core-js/modules/es.string.iterator\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _NestedArrayComponent2 = _interopRequireDefault(require(\"../_classes/nestedarray/NestedArrayComponent\"));\n\nvar _Component = _interopRequireDefault(require(\"../_classes/component/Component\"));\n\nvar _Alert = _interopRequireDefault(require(\"../alert/Alert\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nvar _templates = _interopRequireDefault(require(\"./templates\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar EditRowState = {\n  New: 'new',\n  Editing: 'editing',\n  Saved: 'saved',\n  Viewing: 'viewing',\n  Removed: 'removed',\n  Draft: 'draft'\n};\n\nvar EditGridComponent = /*#__PURE__*/function (_NestedArrayComponent) {\n  _inherits(EditGridComponent, _NestedArrayComponent);\n\n  var _super = _createSuper(EditGridComponent);\n\n  function EditGridComponent() {\n    var _this;\n\n    _classCallCheck(this, EditGridComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.type = 'editgrid';\n    return _this;\n  }\n\n  _createClass(EditGridComponent, [{\n    key: \"defaultDialogTemplate\",\n    get: function get() {\n      return \"\\n    <h3 ref=\\\"dialogHeader\\\">\".concat(this.t('Do you want to clear data?'), \"</h3>\\n    <div style=\\\"display:flex; justify-content: flex-end;\\\">\\n      <button ref=\\\"dialogCancelButton\\\" class=\\\"btn btn-secondary\\\">\").concat(this.t('Cancel'), \"</button>\\n      <button ref=\\\"dialogYesButton\\\" class=\\\"btn btn-danger\\\">\").concat(this.t('Yes, delete it'), \"</button>\\n    </div>\\n  \");\n    }\n    /**\n     * Returns true if the component has nested components which don't trigger changes on the root level\n     */\n\n  }, {\n    key: \"hasScopedChildren\",\n    get: function get() {\n      return !this.inlineEditMode;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return EditGridComponent.schema();\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return [];\n    }\n  }, {\n    key: \"editgridKey\",\n    get: function get() {\n      return \"editgrid-\".concat(this.key);\n    }\n  }, {\n    key: \"rowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-row\");\n    }\n  }, {\n    key: \"rowElements\",\n    get: function get() {\n      return this.refs[this.rowRef];\n    }\n  }, {\n    key: \"rowRefs\",\n    get: function get() {\n      return this.refs[\"editgrid-\".concat(this.component.key, \"-row\")];\n    }\n  }, {\n    key: \"addRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-addRow\");\n    }\n  }, {\n    key: \"addRowElements\",\n    get: function get() {\n      return this.refs[this.addRowRef];\n    }\n  }, {\n    key: \"saveRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-saveRow\");\n    }\n  }, {\n    key: \"saveRowElements\",\n    get: function get() {\n      return this.refs[this.saveRowRef];\n    }\n  }, {\n    key: \"cancelRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-cancelRow\");\n    }\n  }, {\n    key: \"cancelRowElements\",\n    get: function get() {\n      return this.refs[this.cancelRowRef];\n    }\n  }, {\n    key: \"inlineEditMode\",\n    get: function get() {\n      return this.component.inlineEdit;\n    }\n  }, {\n    key: \"saveEditMode\",\n    get: function get() {\n      return !this.inlineEditMode;\n    }\n  }, {\n    key: \"minLength\",\n    get: function get() {\n      return _lodash.default.get(this.component, 'validate.minLength', 0);\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      this._data = value;\n      var data = this.dataValue;\n      (this.editRows || []).forEach(function (row, index) {\n        var rowData = data[index];\n        row.data = rowData;\n        row.components.forEach(function (component) {\n          component.data = rowData;\n        });\n      });\n    }\n  }, {\n    key: \"iteratableRows\",\n    get: function get() {\n      return this.editRows;\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var value = _get(_getPrototypeOf(EditGridComponent.prototype), \"defaultValue\", this);\n\n      var defaultValue = Array.isArray(value) ? value : [];\n\n      _lodash.default.times(this.minLength - defaultValue.length, function () {\n        return defaultValue.push({});\n      });\n\n      return defaultValue;\n    }\n  }, {\n    key: \"loadRefs\",\n    value: function loadRefs(element, refs) {\n      _get(_getPrototypeOf(EditGridComponent.prototype), \"loadRefs\", this).call(this, element, refs);\n\n      var massageContainerRef = 'messageContainer';\n\n      if (refs[\"\".concat(massageContainerRef)] === 'single') {\n        this.refs[\"\".concat(massageContainerRef)] = _toConsumableArray(element.children).filter(function (elem) {\n          var _elem$attributes, _elem$attributes$ref;\n\n          return ((_elem$attributes = elem.attributes) === null || _elem$attributes === void 0 ? void 0 : (_elem$attributes$ref = _elem$attributes.ref) === null || _elem$attributes$ref === void 0 ? void 0 : _elem$attributes$ref.value) === massageContainerRef;\n        })[0];\n      }\n    }\n  }, {\n    key: \"hasRemoveButtons\",\n    value: function hasRemoveButtons() {\n      return !this.component.disableAddingRemovingRows && !this.options.readOnly && !this.disabled && this.fullMode && this.dataValue.length > _lodash.default.get(this.component, 'validate.minLength', 0);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      if (this.builderMode) {\n        this.editRows = [];\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"init\", this).call(this);\n      }\n\n      this.components = this.components || [];\n      var dataValue = this.dataValue || [];\n      var openWhenEmpty = !dataValue.length && this.component.openWhenEmpty;\n\n      if (openWhenEmpty) {\n        var dataObj = {};\n        this.editRows = [];\n        this.createRow(dataObj, 0);\n      } else {\n        this.editRows = dataValue.map(function (row, rowIndex) {\n          return {\n            components: _this2.createRowComponents(row, rowIndex),\n            data: row,\n            state: EditRowState.Saved,\n            backup: null,\n            error: null\n          };\n        });\n      }\n\n      this.prevHasAddButton = this.hasAddButton();\n      this.checkData();\n    }\n  }, {\n    key: \"isOpen\",\n    value: function isOpen(editRow) {\n      return [EditRowState.New, EditRowState.Editing, EditRowState.Viewing].includes(editRow.state);\n    }\n  }, {\n    key: \"isComponentVisibleInSomeRow\",\n    value: function isComponentVisibleInSomeRow(component) {\n      var _this3 = this;\n\n      var rows = this.editRows;\n\n      if (_lodash.default.isEmpty(rows)) {\n        var rowComponents = this.createRowComponents({}, 0);\n        var checkComponent;\n        (0, _utils.eachComponent)(rowComponents, function (comp) {\n          if (comp.component.key === component.key) {\n            checkComponent = comp;\n          }\n\n          comp.checkConditions();\n        });\n        var isVisible = checkComponent ? checkComponent.visible : true;\n\n        _toConsumableArray(this.components).forEach(function (comp) {\n          return _this3.removeComponent(comp, _this3.components);\n        });\n\n        return isVisible;\n      }\n\n      return _lodash.default.some(rows, function (row, index) {\n        var flattenedComponents = _this3.flattenComponents(index);\n\n        var instance = flattenedComponents[component.key];\n        return instance ? instance.visible : true;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render(children) {\n      var _this4 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"render\", this).call(this);\n      }\n\n      var dataValue = this.dataValue || [];\n      var headerTemplate = _utils.Evaluator.noeval ? _templates.default.header : _lodash.default.get(this.component, 'templates.header');\n      var t = this.t.bind(this);\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"render\", this).call(this, children || this.renderTemplate('editgrid', {\n        ref: {\n          row: this.rowRef,\n          addRow: this.addRowRef,\n          saveRow: this.saveRowRef,\n          cancelRow: this.cancelRowRef\n        },\n        header: this.renderString(headerTemplate, {\n          displayValue: function displayValue(component) {\n            return _this4.displayComponentValue(component);\n          },\n          components: this.component.components,\n          value: dataValue,\n          t: t\n        }),\n        footer: this.renderString(_lodash.default.get(this.component, 'templates.footer'), {\n          components: this.component.components,\n          value: dataValue,\n          t: t\n        }),\n        rows: this.editRows.map(this.renderRow.bind(this)),\n        openRows: this.editRows.map(function (row) {\n          return _this4.isOpen(row);\n        }),\n        errors: this.editRows.map(function (row) {\n          return row.error;\n        }),\n        hasAddButton: this.hasAddButton(),\n        hasRemoveButtons: this.hasRemoveButtons()\n      }));\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this$loadRefs,\n          _this5 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"attach\", this).call(this, element);\n      }\n\n      this.loadRefs(element, (_this$loadRefs = {}, _defineProperty(_this$loadRefs, this.addRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.saveRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.cancelRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.rowRef, 'multiple'), _this$loadRefs));\n      this.addRowElements.forEach(function (addButton) {\n        _this5.addEventListener(addButton, 'click', function () {\n          return _this5.addRow();\n        });\n      });\n      var openRowCount = 0;\n      this.rowElements.forEach(function (row, rowIndex) {\n        var _this5$dataValue$rowI;\n\n        var editRow = _this5.editRows[rowIndex];\n\n        if ((_this5$dataValue$rowI = _this5.dataValue[rowIndex]) !== null && _this5$dataValue$rowI !== void 0 && _this5$dataValue$rowI.isRowSelected) {\n          row.classList.add('selected');\n        }\n\n        if (_this5.isOpen(editRow)) {\n          _this5.attachComponents(row, editRow.components);\n\n          _this5.addEventListener(_this5.saveRowElements[openRowCount], 'click', function () {\n            return _this5.saveRow(rowIndex, true);\n          });\n\n          _this5.addEventListener(_this5.cancelRowElements[openRowCount], 'click', function () {\n            return _this5.cancelRow(rowIndex);\n          });\n\n          openRowCount++;\n        } else {\n          // Attach edit and remove button events.\n          [{\n            className: 'removeRow',\n            event: 'click',\n            action: function action() {\n              return _this5.removeRow(rowIndex, true);\n            }\n          }, {\n            className: 'editRow',\n            event: 'click',\n            action: function action() {\n              _this5.editRow(rowIndex).then(function () {\n                if (_this5.component.rowDrafts) {\n                  var _this5$root;\n\n                  _this5.validateRow(editRow, false);\n\n                  var hasErrors = editRow.errors && !!editRow.errors.length;\n                  var shouldShowRowErrorsAlert = _this5.component.modal && hasErrors && ((_this5$root = _this5.root) === null || _this5$root === void 0 ? void 0 : _this5$root.submitted);\n\n                  if (shouldShowRowErrorsAlert) {\n                    _this5.alert.showErrors(editRow.errors, false);\n\n                    editRow.alerts = true;\n                  }\n                }\n              });\n            }\n          }, {\n            className: 'row',\n            event: 'click',\n            action: function action() {\n              row.classList.toggle('selected');\n              var eventName = 'editGridSelectRow';\n\n              if (Array.from(row.classList).includes('selected')) {\n                _this5.dataValue[rowIndex].isRowSelected = true;\n              } else {\n                delete _this5.dataValue[rowIndex].isRowSelected;\n                eventName = 'editGridUnSelectRow';\n              }\n\n              _this5.emit(eventName, {\n                component: _this5.component,\n                data: _this5.dataValue[rowIndex]\n              });\n            }\n          }].forEach(function (_ref) {\n            var className = _ref.className,\n                event = _ref.event,\n                action = _ref.action;\n            var elements = row.getElementsByClassName(className);\n            Array.prototype.forEach.call(elements, function (element) {\n              _this5.addEventListener(element, event, action);\n            });\n          });\n        }\n      }); // Add open class to the element if any edit grid row is open\n\n      if (openRowCount) {\n        this.addClass(this.refs.component, \"formio-component-\".concat(this.component.type, \"-row-open\"));\n      } else {\n        this.removeClass(this.refs.component, \"formio-component-\".concat(this.component.type, \"-row-open\"));\n      }\n\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"attach\", this).call(this, element);\n    }\n  }, {\n    key: \"flattenRowDataValue\",\n    value: function flattenRowDataValue(dataValue) {\n      var _this6 = this;\n\n      var flattened = {};\n      Object.keys(dataValue).forEach(function (key) {\n        if (_lodash.default.isObject(dataValue[key]) && !_lodash.default.isNil(dataValue[key])) {\n          Object.assign(flattened, _this6.flattenRowDataValue(dataValue[key]));\n        } else {\n          flattened[key] = dataValue[key];\n        }\n      });\n      return flattened;\n    }\n  }, {\n    key: \"isComponentVisibleInRow\",\n    value: function isComponentVisibleInRow(component, flattenedComponents) {\n      var instance = flattenedComponents[component.key];\n      return instance ? instance.visible : true;\n    }\n  }, {\n    key: \"displayComponentValue\",\n    value: function displayComponentValue(component) {\n      return !!((!component.hasOwnProperty('tableView') || component.tableView) && this.isComponentVisibleInSomeRow(component));\n    }\n  }, {\n    key: \"renderRow\",\n    value: function renderRow(row, rowIndex) {\n      var _this7 = this;\n\n      var dataValue = this.dataValue || [];\n\n      if (this.isOpen(row)) {\n        return this.renderComponents(row.components);\n      } else {\n        var flattenedComponents = this.flattenComponents(rowIndex);\n        var rowTemplate = _utils.Evaluator.noeval ? _templates.default.row : _lodash.default.get(this.component, 'templates.row', EditGridComponent.defaultRowTemplate);\n        return this.renderString(rowTemplate, {\n          row: dataValue[rowIndex] || {},\n          data: this.data,\n          rowIndex: rowIndex,\n          components: this.component.components,\n          flattenedComponents: flattenedComponents,\n          displayValue: function displayValue(component) {\n            return _this7.displayComponentValue(component);\n          },\n          isVisibleInRow: function isVisibleInRow(component) {\n            return _this7.isComponentVisibleInRow(component, flattenedComponents);\n          },\n          getView: function getView(component, data) {\n            var _instance$component;\n\n            var instance = flattenedComponents[component.key];\n            var view = instance ? instance.getView(data || instance.dataValue) : ''; // If there is an html tag in view, don't allow it to be injected in template\n\n            var htmlTagRegExp = new RegExp('<(.*?)>');\n            return typeof view === 'string' && view.length && !((_instance$component = instance.component) !== null && _instance$component !== void 0 && _instance$component.template) && htmlTagRegExp.test(view) ? \"<input type=\\\"text\\\" value=\\\"\".concat(view.replace(/\"/g, '&quot;'), \"\\\" readonly/>\") : view;\n          },\n          state: this.editRows[rowIndex].state,\n          t: this.t.bind(this)\n        });\n      }\n    }\n  }, {\n    key: \"eachComponent\",\n    value: function eachComponent(fn, rowIndex) {\n      _lodash.default.each(this.getComponents(rowIndex), function (component, index) {\n        if (fn(component, index) === false) {\n          return false;\n        }\n      });\n    }\n  }, {\n    key: \"restoreComponentsContext\",\n    value: function restoreComponentsContext() {\n      var _this8 = this;\n\n      this.getComponents().forEach(function (component) {\n        var _this8$editRows$compo;\n\n        var rowData = _this8.dataValue[component.rowIndex];\n        var editRowData = (_this8$editRows$compo = _this8.editRows[component.rowIndex]) === null || _this8$editRows$compo === void 0 ? void 0 : _this8$editRows$compo.data;\n        component.data = rowData || editRowData;\n      });\n    }\n  }, {\n    key: \"flattenComponents\",\n    value: function flattenComponents(rowIndex) {\n      var result = {};\n      this.everyComponent(function (component) {\n        result[component.component.flattenAs || component.key] = component;\n      }, rowIndex);\n      return result;\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents(rowIndex) {\n      // Ensure editrows is set.\n      this.editRows = this.editRows || [];\n      return this.builderMode ? _get(_getPrototypeOf(EditGridComponent.prototype), \"getComponents\", this).call(this) : _lodash.default.isNumber(rowIndex) ? this.editRows[rowIndex].components || [] : this.editRows.reduce(function (result, row) {\n        return result.concat(row.components || []);\n      }, []);\n    }\n  }, {\n    key: \"destroyComponents\",\n    value: function destroyComponents(rowIndex) {\n      var _this9 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"destroyComponents\", this).call(this);\n      }\n\n      var components = this.getComponents(rowIndex).slice();\n      components.forEach(function (comp) {\n        return _this9.removeComponent(comp, _this9.components);\n      });\n    }\n  }, {\n    key: \"createRow\",\n    value: function createRow(dataObj, rowIndex) {\n      var editRow = {\n        components: this.createRowComponents(dataObj, rowIndex),\n        data: dataObj,\n        state: EditRowState.New,\n        backup: null,\n        error: null\n      };\n      this.editRows.push(editRow);\n\n      if (this.inlineEditMode) {\n        this.dataValue.push(dataObj);\n      }\n\n      return editRow;\n    }\n  }, {\n    key: \"addRow\",\n    value: function addRow() {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var dataObj = {};\n      var rowIndex = this.editRows.length;\n      var editRow = this.createRow(dataObj, rowIndex);\n\n      if (this.inlineEditMode) {\n        this.triggerChange();\n      }\n\n      this.emit('editGridAddRow', {\n        component: this.component,\n        row: editRow\n      });\n      this.checkRow('checkData', null, {}, editRow.data, editRow.components);\n\n      if (this.component.modal) {\n        this.addRowModal(rowIndex);\n      } else {\n        this.redraw();\n      }\n\n      return editRow;\n    }\n  }, {\n    key: \"addRowModal\",\n    value: function addRowModal(rowIndex) {\n      var _this10 = this;\n\n      var modalContent = this.ce('div');\n      var editRow = this.editRows[rowIndex];\n      editRow.willBeSaved = false;\n      var components = editRow.components;\n      modalContent.innerHTML = this.renderComponents(components);\n      var dialog = this.component.modal ? this.createModal(modalContent, {}, function () {\n        return _this10.showDialog(rowIndex);\n      }) : undefined;\n      dialog.classList.add(\"editgrid-row-modal-\".concat(this.id));\n      editRow.dialog = dialog;\n\n      if (this.alert) {\n        this.alert.clear();\n        this.alert = null;\n      }\n\n      this.alert = new _Alert.default(dialog.refs.dialogContents, this);\n      this.addEventListener(dialog, 'close', function () {\n        if (!editRow.willBeSaved) {\n          _this10.cancelRow(rowIndex);\n        }\n\n        if (_this10.alert) {\n          _this10.alert.clear();\n\n          _this10.alert = null;\n        } // Remove references to dialog elements to prevent possible in some cases memory leaks\n\n\n        delete editRow.confirmationDialog;\n        delete editRow.dialog;\n      });\n      dialog.refs.dialogContents.appendChild(this.ce('button', {\n        class: 'btn btn-primary',\n        onClick: function onClick() {\n          if (_this10.validateRow(editRow, true) || _this10.component.rowDrafts) {\n            editRow.willBeSaved = true;\n            dialog.close();\n\n            _this10.saveRow(rowIndex, true);\n          } else {\n            _this10.alert.showErrors(editRow.errors, false);\n\n            editRow.alerts = true;\n          }\n        }\n      }, this.component.saveRow || 'Save'));\n      return this.attachComponents(modalContent, components);\n    }\n  }, {\n    key: \"showDialog\",\n    value: function showDialog(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n\n      if (_lodash.default.isEqual(editRow.backup, editRow.data)) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      var wrapper = this.ce('div', {\n        ref: 'confirmationDialog'\n      });\n      var dialogContent = this.component.dialogTemplate || this.defaultDialogTemplate;\n      wrapper.innerHTML = dialogContent;\n      wrapper.refs = {};\n      this.loadRefs.call(wrapper, wrapper, {\n        dialogHeader: 'single',\n        dialogCancelButton: 'single',\n        dialogYesButton: 'single'\n      });\n      var dialog = this.createModal(wrapper);\n      dialog.classList.add(\"editgrid-row-modal-confirmation-\".concat(this.id));\n\n      var close = function close(event) {\n        event.preventDefault();\n        dialog.close();\n      };\n\n      var dialogResult;\n      var promise = new _nativePromiseOnly.default(function (resolve, reject) {\n        dialogResult = {\n          resolve: resolve,\n          reject: reject\n        };\n      });\n      this.addEventListener(wrapper.refs.dialogYesButton, 'click', function (event) {\n        close(event);\n        dialogResult.resolve();\n      });\n      this.addEventListener(wrapper.refs.dialogCancelButton, 'click', function (event) {\n        close(event);\n        dialogResult.reject();\n      });\n      editRow.confirmationDialog = dialog;\n      return promise;\n    }\n  }, {\n    key: \"editRow\",\n    value: function editRow(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n      var isAlreadyEditing = editRow.state === EditRowState.Editing || editRow.state === EditRowState.New;\n\n      if (!editRow || isAlreadyEditing) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      editRow.prevState = editRow.state;\n      editRow.state = this.options.readOnly ? EditRowState.Viewing : EditRowState.Editing;\n      var dataSnapshot = (0, _utils.fastCloneDeep)(editRow.data);\n\n      if (this.inlineEditMode) {\n        editRow.backup = dataSnapshot;\n      } else {\n        editRow.backup = (0, _utils.fastCloneDeep)(editRow.data);\n        editRow.data = dataSnapshot;\n        this.restoreRowContext(editRow);\n      }\n\n      if (this.component.modal) {\n        return this.addRowModal(rowIndex);\n      }\n\n      return this.redraw();\n    }\n  }, {\n    key: \"clearErrors\",\n    value: function clearErrors(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n\n      if (editRow && Array.isArray(editRow.components)) {\n        editRow.components.forEach(function (comp) {\n          comp.setPristine(true);\n          comp.setCustomValidity('');\n        });\n      }\n    }\n  }, {\n    key: \"cancelRow\",\n    value: function cancelRow(rowIndex) {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var editRow = this.editRows[rowIndex];\n\n      switch (editRow.state) {\n        case EditRowState.New:\n          {\n            editRow.state = EditRowState.Removed;\n            this.clearErrors(rowIndex);\n            this.destroyComponents(rowIndex);\n\n            if (this.inlineEditMode) {\n              this.splice(rowIndex);\n            }\n\n            this.editRows.splice(rowIndex, 1);\n            break;\n          }\n\n        case EditRowState.Editing:\n          {\n            editRow.state = editRow.prevState;\n\n            if (this.inlineEditMode) {\n              this.dataValue[rowIndex] = editRow.backup;\n            }\n\n            editRow.data = editRow.backup;\n            editRow.backup = null;\n            this.restoreRowContext(editRow);\n\n            if (!this.component.rowDrafts) {\n              this.clearErrors(rowIndex);\n            }\n\n            break;\n          }\n      }\n\n      this.checkValidity(null, true);\n      this.redraw();\n\n      if (this.component.rowDrafts) {\n        this.checkValidity(this.data, false);\n      }\n    }\n  }, {\n    key: \"saveRow\",\n    value: function saveRow(rowIndex, modified) {\n      var _this11 = this;\n\n      var editRow = this.editRows[rowIndex];\n\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var isRowValid = this.validateRow(editRow, true);\n\n      if (!this.component.rowDrafts) {\n        if (!isRowValid) {\n          return false;\n        }\n      }\n\n      if (this.saveEditMode) {\n        var dataValue = this.dataValue || [];\n\n        switch (editRow.state) {\n          case EditRowState.New:\n            {\n              var newIndex = dataValue.length;\n              dataValue.push(editRow.data);\n\n              if (rowIndex !== newIndex) {\n                this.editRows.splice(rowIndex, 1);\n                this.editRows.splice(newIndex, 0, editRow);\n              }\n\n              break;\n            }\n\n          case EditRowState.Editing:\n            {\n              dataValue[rowIndex] = editRow.data;\n              break;\n            }\n        }\n      }\n\n      editRow.state = this.component.rowDrafts && !isRowValid ? EditRowState.Draft : EditRowState.Saved;\n      editRow.backup = null;\n      this.updateValue();\n      this.emit('editGridSaveRow', {\n        component: this.component,\n        row: editRow.data\n      });\n      this.triggerChange({\n        modified: modified,\n        noPristineChangeOnModified: modified && this.component.rowDrafts,\n        isolateRow: true\n      });\n\n      if (this.component.rowDrafts) {\n        editRow.components.forEach(function (comp) {\n          return comp.setPristine(_this11.pristine);\n        });\n      }\n\n      this.checkValidity(null, true);\n      this.redraw();\n\n      if (editRow.alerts) {\n        editRow.alerts = false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"beforeFocus\",\n    value: function beforeFocus(component) {\n      if ('beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n\n      var relativePath = this.getRelativePath(component.path);\n      var arrayPath = (0, _utils.getArrayFromComponentPath)(relativePath);\n\n      if (_lodash.default.isNumber(arrayPath[0])) {\n        this.editRow(arrayPath[0]);\n      }\n    }\n  }, {\n    key: \"updateComponentsRowIndex\",\n    value: function updateComponentsRowIndex(components, rowIndex) {\n      components.forEach(function (component, colIndex) {\n        component.rowIndex = rowIndex;\n        component.row = \"\".concat(rowIndex, \"-\").concat(colIndex);\n      });\n    }\n  }, {\n    key: \"updateRowsComponents\",\n    value: function updateRowsComponents(rowIndex) {\n      var _this12 = this;\n\n      this.editRows.slice(rowIndex).forEach(function (row, index) {\n        _this12.updateComponentsRowIndex(row.components, rowIndex + index);\n      });\n    }\n  }, {\n    key: \"baseRemoveRow\",\n    value: function baseRemoveRow(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n      editRow.state = EditRowState.Removed;\n      this.destroyComponents(rowIndex);\n      return editRow;\n    }\n  }, {\n    key: \"removeRow\",\n    value: function removeRow(rowIndex, modified) {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      this.baseRemoveRow(rowIndex);\n      this.splice(rowIndex);\n      this.emit('editGridDeleteRow', {\n        index: rowIndex\n      });\n      this.editRows.splice(rowIndex, 1);\n      this.updateRowsComponents(rowIndex);\n      this.updateValue();\n      this.triggerChange({\n        modified: modified,\n        noPristineChangeOnModified: modified && this.component.rowDrafts,\n        isolateRow: true\n      });\n      this.checkValidity(null, true);\n      this.checkData();\n      this.redraw();\n    }\n  }, {\n    key: \"createRowComponents\",\n    value: function createRowComponents(row, rowIndex) {\n      var _this13 = this;\n\n      return this.component.components.map(function (col, colIndex) {\n        var column = _lodash.default.clone(col);\n\n        var options = _lodash.default.clone(_this13.options);\n\n        options.name += \"[\".concat(rowIndex, \"]\");\n        options.row = \"\".concat(rowIndex, \"-\").concat(colIndex);\n\n        options.onChange = function () {\n          var _changed$instance$roo, _this13$root;\n\n          var flags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n          var changed = arguments.length > 1 ? arguments[1] : undefined;\n          var modified = arguments.length > 2 ? arguments[2] : undefined;\n\n          if ((_changed$instance$roo = changed.instance.root) !== null && _changed$instance$roo !== void 0 && _changed$instance$roo.id && ((_this13$root = _this13.root) === null || _this13$root === void 0 ? void 0 : _this13$root.id) !== changed.instance.root.id) {\n            changed.instance.root.triggerChange(_objectSpread(_objectSpread({}, flags), {}, {\n              noValidate: true\n            }), changed, modified);\n          } else {\n            _this13.triggerRootChange(_objectSpread(_objectSpread({}, flags), {}, {\n              noValidate: true\n            }), changed, modified);\n          }\n\n          if (_this13.inlineEditMode) {\n            return;\n          }\n\n          var editRow = _this13.editRows[rowIndex];\n\n          if (editRow !== null && editRow !== void 0 && editRow.alerts) {\n            _this13.checkData(null, _objectSpread(_objectSpread({}, flags), {}, {\n              changed: changed,\n              rowIndex: rowIndex\n            }), _this13.data);\n          } else if (editRow) {\n            // If drafts allowed, perform validation silently if there was no attempt to submit a form\n            var silentCheck = _this13.component.rowDrafts && !_this13.shouldValidateDraft(editRow);\n\n            _this13.checkRow('checkData', null, _objectSpread(_objectSpread({}, flags), {}, {\n              changed: changed,\n              silentCheck: silentCheck\n            }), editRow.data, editRow.components, silentCheck);\n          }\n        };\n\n        var comp = _this13.createComponent(_lodash.default.assign({}, column, {\n          row: options.row\n        }), options, row);\n\n        comp.rowIndex = rowIndex;\n        comp.inEditGrid = true;\n        return comp;\n      });\n    }\n  }, {\n    key: \"hasOpenRows\",\n    value: function hasOpenRows() {\n      var _this14 = this;\n\n      return this.editRows.some(function (row) {\n        return _this14.isOpen(row);\n      });\n    }\n  }, {\n    key: \"shouldValidateDraft\",\n    value: function shouldValidateDraft(editRow) {\n      var _this$root, _this$root2; // Draft rows should be validated only when there was an attempt to submit a form\n\n\n      return editRow.state === EditRowState.Draft && !this.pristine && !((_this$root = this.root) !== null && _this$root !== void 0 && _this$root.pristine) && !this.hasOpenRows() || ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : _this$root2.submitted);\n    }\n  }, {\n    key: \"shouldValidateRow\",\n    value: function shouldValidateRow(editRow, dirty) {\n      return this.shouldValidateDraft(editRow) || editRow.state === EditRowState.Editing || dirty;\n    }\n  }, {\n    key: \"validateRow\",\n    value: function validateRow(editRow, dirty) {\n      var _this15 = this,\n          _this$root3;\n\n      var valid = true;\n\n      var errorsSnapshot = _toConsumableArray(this.errors);\n\n      if (this.shouldValidateRow(editRow, dirty)) {\n        editRow.components.forEach(function (comp) {\n          if (!_this15.component.rowDrafts) {\n            comp.setPristine(!dirty);\n          }\n\n          var silentCheck = _this15.component.rowDrafts && !_this15.shouldValidateDraft(editRow);\n          valid &= comp.checkValidity(null, dirty, editRow.data, silentCheck);\n        });\n      }\n\n      if (this.component.validate && this.component.validate.row) {\n        valid = this.evaluate(this.component.validate.row, {\n          valid: valid,\n          row: editRow.data\n        }, 'valid', true);\n\n        if (valid.toString() !== 'true') {\n          editRow.error = valid;\n          valid = false;\n        } else {\n          editRow.error = null;\n        }\n\n        if (valid === null) {\n          valid = \"Invalid row validation for \".concat(this.key);\n        }\n      }\n\n      editRow.errors = !valid ? this.errors.filter(function (err) {\n        return !errorsSnapshot.includes(err);\n      }) : null;\n\n      if (!this.component.rowDrafts || (_this$root3 = this.root) !== null && _this$root3 !== void 0 && _this$root3.submitted) {\n        this.showRowErrorAlerts(editRow, !!valid);\n      }\n\n      return !!valid;\n    }\n  }, {\n    key: \"showRowErrorAlerts\",\n    value: function showRowErrorAlerts(editRow, valid) {\n      if (editRow.alerts) {\n        if (this.alert) {\n          var _editRow$errors;\n\n          if ((_editRow$errors = editRow.errors) !== null && _editRow$errors !== void 0 && _editRow$errors.length && !valid) {\n            this.alert.showErrors(editRow.errors, false);\n            editRow.alerts = true;\n          } else {\n            this.alert.clear();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      data = data || this.rootValue;\n      row = row || this.data;\n\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      return this.checkComponentValidity(data, dirty, row, {\n        silentCheck: silentCheck\n      });\n    }\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row, options) {\n      var _this16 = this;\n\n      var superValid = _get(_getPrototypeOf(EditGridComponent.prototype), \"checkComponentValidity\", this).call(this, data, dirty, row, options); // If super tells us that component invalid and there is no need to update alerts, just return false\n\n\n      if (!superValid && (!this.alert || !this.hasOpenRows())) {\n        return false;\n      }\n\n      if (this.shouldSkipValidation(data, dirty, row)) {\n        return true;\n      }\n\n      var rowsValid = true;\n      var rowsEditing = false;\n      this.editRows.forEach(function (editRow, index) {\n        // Trigger all errors on the row.\n        var rowValid = _this16.validateRow(editRow, editRow.alerts || dirty);\n\n        rowsValid &= rowValid;\n\n        if (_this16.rowRefs) {\n          var rowContainer = _this16.rowRefs[index];\n\n          if (rowContainer) {\n            var errorContainer = rowContainer.querySelector('.editgrid-row-error');\n\n            if (!rowValid && errorContainer) {\n              errorContainer.textContent = _this16.t('invalidRowError');\n            }\n          }\n        } // If this is a dirty check, and any rows are still editing, we need to throw validation error.\n\n\n        rowsEditing |= dirty && _this16.isOpen(editRow);\n      });\n\n      if (!rowsValid) {\n        this.setCustomValidity(this.t('invalidRowsError'), dirty);\n        return false;\n      } else if (rowsEditing && this.saveEditMode) {\n        this.setCustomValidity(this.t('unsavedRowsError'), dirty);\n        return false;\n      }\n\n      var message = this.invalid || this.invalidMessage(data, dirty);\n      this.setCustomValidity(message, dirty);\n      return superValid;\n    }\n  }, {\n    key: \"changeState\",\n    value: function changeState(changed, flags) {\n      if (changed || flags.resetValue && this.component.modalEdit) {\n        this.rebuild();\n      } else {\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this17 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!value) {\n        value = this.defaultValue;\n      }\n\n      if (!Array.isArray(value)) {\n        if (_typeof(value) === 'object') {\n          value = [value];\n        } else {\n          return false;\n        }\n      }\n\n      var changed = this.hasChanged(value, this.dataValue);\n      this.dataValue = value; // Refresh editRow data when data changes.\n\n      this.dataValue.forEach(function (row, rowIndex) {\n        var editRow = _this17.editRows[rowIndex];\n\n        if (editRow) {\n          editRow.data = row;\n\n          _this17.restoreRowContext(editRow, flags);\n\n          editRow.state = EditRowState.Saved;\n          editRow.backup = null;\n          editRow.error = null;\n        } else {\n          _this17.editRows[rowIndex] = {\n            components: _this17.createRowComponents(row, rowIndex),\n            data: row,\n            state: EditRowState.Saved,\n            backup: null,\n            error: null\n          };\n        }\n      });\n      var dataLength = this.dataValue.length; // If the last row is a new row, then do not remove it.\n\n      if (this.editRows[dataLength] && this.editRows[dataLength].state === EditRowState.New) {\n        dataLength = dataLength + 1;\n      }\n\n      this.editRows.slice(dataLength).forEach(function (editRow, index) {\n        return _this17.baseRemoveRow(dataLength + index);\n      });\n      this.editRows = this.editRows.slice(0, dataLength);\n      var shouldBeOpened = !this.dataValue.length && this.component.openWhenEmpty;\n      var hasNoRows = !this.editRows.length;\n\n      if (hasNoRows && shouldBeOpened && !this.builderMode) {\n        var dataObj = {};\n        this.createRow(dataObj, 0);\n      }\n\n      this.updateOnChange(flags, changed);\n      this.checkData();\n      this.changeState(changed, flags);\n      return changed;\n    }\n  }, {\n    key: \"restoreRowContext\",\n    value: function restoreRowContext(editRow) {\n      var _this18 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      editRow.components.forEach(function (component) {\n        component.data = editRow.data;\n\n        _this18.setNestedValue(component, editRow.data, flags);\n      });\n    }\n  }, {\n    key: \"emptyRows\",\n    value: function emptyRows() {\n      var _this19 = this;\n\n      this.editRows.forEach(function (editRow, index) {\n        return _this19.destroyComponents(index);\n      });\n      this.editRows = [];\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _get(_getPrototypeOf(EditGridComponent.prototype), \"resetValue\", this).call(this);\n\n      this.emptyRows();\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _NestedArrayComponent2.default.schema.apply(_NestedArrayComponent2.default, [{\n        type: 'editgrid',\n        label: 'Edit Grid',\n        key: 'editGrid',\n        clearOnHide: true,\n        input: true,\n        tree: true,\n        removeRow: 'Cancel',\n        defaultOpen: false,\n        openWhenEmpty: false,\n        modal: false,\n        components: [],\n        inlineEdit: false,\n        templates: {\n          header: EditGridComponent.defaultHeaderTemplate,\n          row: EditGridComponent.defaultRowTemplate,\n          footer: ''\n        }\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Edit Grid',\n        icon: 'tasks',\n        group: 'data',\n        documentation: '/userguide/#editgrid',\n        weight: 30,\n        schema: EditGridComponent.schema()\n      };\n    }\n  }, {\n    key: \"defaultHeaderTemplate\",\n    get: function get() {\n      return \"<div class=\\\"row\\\">\\n      {% util.eachComponent(components, function(component) { %}\\n        {% if (displayValue(component)) { %}\\n          <div class=\\\"col-sm-2\\\">{{ t(component.label) }}</div>\\n        {% } %}\\n      {% }) %}\\n    </div>\";\n    }\n  }, {\n    key: \"defaultRowTemplate\",\n    get: function get() {\n      return \"<div class=\\\"row\\\">\\n      {% util.eachComponent(components, function(component) { %}\\n        {% if (displayValue(component)) { %}\\n          <div class=\\\"col-sm-2\\\">\\n            {{ isVisibleInRow(component) ? getView(component, row[component.key]) : ''}}\\n          </div>\\n        {% } %}\\n      {% }) %}\\n      {% if (!instance.options.readOnly && !instance.disabled) { %}\\n        <div class=\\\"col-sm-2\\\">\\n          <div class=\\\"btn-group pull-right\\\">\\n            <button class=\\\"btn btn-default btn-light btn-sm editRow\\\"><i class=\\\"{{ iconClass('edit') }}\\\"></i></button>\\n            {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\\n              <button class=\\\"btn btn-danger btn-sm removeRow\\\"><i class=\\\"{{ iconClass('trash') }}\\\"></i></button>\\n            {% } %}\\n          </div>\\n        </div>\\n      {% } %}\\n    </div>\";\n    }\n  }]);\n\n  return EditGridComponent;\n}(_NestedArrayComponent2.default);\n\nexports.default = EditGridComponent;\nEditGridComponent.prototype.hasChanged = _Component.default.prototype.hasChanged;","map":{"version":3,"sources":["C:/Users/34644/ProyectoFinalDAW/mycovid19/node_modules/formiojs/components/editgrid/EditGrid.js"],"names":["Object","defineProperty","exports","value","default","_lodash","_interopRequireDefault","require","_nativePromiseOnly","_NestedArrayComponent2","_Component","_Alert","_utils","_templates","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","toString","call","slice","name","Array","from","test","iter","isArray","len","arr2","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","_get","property","receiver","get","base","_superPropBase","desc","hasOwnProperty","getPrototypeOf","EditRowState","New","Editing","Saved","Viewing","Removed","Draft","EditGridComponent","_NestedArrayComponent","_super","_this","_len","args","_key","concat","type","t","inlineEditMode","schema","editgridKey","refs","rowRef","component","addRowRef","saveRowRef","cancelRowRef","inlineEdit","_data","set","data","dataValue","editRows","row","index","rowData","components","defaultValue","times","minLength","loadRefs","element","massageContainerRef","children","elem","_elem$attributes","_elem$attributes$ref","attributes","ref","hasRemoveButtons","disableAddingRemovingRows","options","readOnly","disabled","fullMode","init","_this2","builderMode","openWhenEmpty","dataObj","createRow","map","rowIndex","createRowComponents","state","backup","error","prevHasAddButton","hasAddButton","checkData","isOpen","editRow","includes","isComponentVisibleInSomeRow","_this3","rows","isEmpty","rowComponents","checkComponent","eachComponent","comp","checkConditions","isVisible","visible","removeComponent","some","flattenedComponents","flattenComponents","render","_this4","headerTemplate","Evaluator","noeval","header","bind","renderTemplate","addRow","saveRow","cancelRow","renderString","displayValue","displayComponentValue","footer","renderRow","openRows","errors","attach","_this$loadRefs","_this5","addRowElements","addButton","addEventListener","openRowCount","rowElements","_this5$dataValue$rowI","isRowSelected","classList","add","attachComponents","saveRowElements","cancelRowElements","className","event","action","removeRow","then","rowDrafts","_this5$root","validateRow","hasErrors","shouldShowRowErrorsAlert","modal","root","submitted","alert","showErrors","alerts","toggle","eventName","emit","_ref","elements","getElementsByClassName","addClass","removeClass","flattenRowDataValue","_this6","flattened","isObject","isNil","assign","isComponentVisibleInRow","tableView","_this7","renderComponents","rowTemplate","defaultRowTemplate","isVisibleInRow","getView","_instance$component","view","htmlTagRegExp","RegExp","template","replace","fn","each","getComponents","restoreComponentsContext","_this8","_this8$editRows$compo","editRowData","everyComponent","flattenAs","isNumber","reduce","destroyComponents","_this9","triggerChange","checkRow","addRowModal","redraw","_this10","modalContent","ce","willBeSaved","innerHTML","dialog","createModal","showDialog","undefined","id","clear","dialogContents","confirmationDialog","appendChild","class","onClick","close","isEqual","resolve","wrapper","dialogContent","dialogTemplate","defaultDialogTemplate","dialogHeader","dialogCancelButton","dialogYesButton","preventDefault","dialogResult","promise","reject","isAlreadyEditing","prevState","dataSnapshot","fastCloneDeep","restoreRowContext","clearErrors","setPristine","setCustomValidity","splice","checkValidity","modified","_this11","isRowValid","saveEditMode","newIndex","updateValue","noPristineChangeOnModified","isolateRow","pristine","beforeFocus","parent","relativePath","getRelativePath","path","arrayPath","getArrayFromComponentPath","updateComponentsRowIndex","colIndex","updateRowsComponents","_this12","baseRemoveRow","_this13","col","column","clone","onChange","_changed$instance$roo","_this13$root","flags","changed","noValidate","triggerRootChange","silentCheck","shouldValidateDraft","createComponent","inEditGrid","hasOpenRows","_this14","_this$root","_this$root2","shouldValidateRow","dirty","_this15","_this$root3","valid","errorsSnapshot","validate","evaluate","err","showRowErrorAlerts","_editRow$errors","rootValue","checkCondition","checkComponentValidity","_this16","superValid","shouldSkipValidation","rowsValid","rowsEditing","rowValid","rowRefs","rowContainer","errorContainer","querySelector","textContent","message","invalid","invalidMessage","changeState","resetValue","modalEdit","rebuild","setValue","_this17","hasChanged","dataLength","shouldBeOpened","hasNoRows","updateOnChange","_this18","setNestedValue","emptyRows","_this19","_len2","extend","_key2","label","clearOnHide","input","tree","defaultOpen","templates","defaultHeaderTemplate","title","icon","group","documentation","weight"],"mappings":"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","sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _NestedArrayComponent2 = _interopRequireDefault(require(\"../_classes/nestedarray/NestedArrayComponent\"));\n\nvar _Component = _interopRequireDefault(require(\"../_classes/component/Component\"));\n\nvar _Alert = _interopRequireDefault(require(\"../alert/Alert\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nvar _templates = _interopRequireDefault(require(\"./templates\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar EditRowState = {\n  New: 'new',\n  Editing: 'editing',\n  Saved: 'saved',\n  Viewing: 'viewing',\n  Removed: 'removed',\n  Draft: 'draft'\n};\n\nvar EditGridComponent = /*#__PURE__*/function (_NestedArrayComponent) {\n  _inherits(EditGridComponent, _NestedArrayComponent);\n\n  var _super = _createSuper(EditGridComponent);\n\n  function EditGridComponent() {\n    var _this;\n\n    _classCallCheck(this, EditGridComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.type = 'editgrid';\n    return _this;\n  }\n\n  _createClass(EditGridComponent, [{\n    key: \"defaultDialogTemplate\",\n    get: function get() {\n      return \"\\n    <h3 ref=\\\"dialogHeader\\\">\".concat(this.t('Do you want to clear data?'), \"</h3>\\n    <div style=\\\"display:flex; justify-content: flex-end;\\\">\\n      <button ref=\\\"dialogCancelButton\\\" class=\\\"btn btn-secondary\\\">\").concat(this.t('Cancel'), \"</button>\\n      <button ref=\\\"dialogYesButton\\\" class=\\\"btn btn-danger\\\">\").concat(this.t('Yes, delete it'), \"</button>\\n    </div>\\n  \");\n    }\n    /**\n     * Returns true if the component has nested components which don't trigger changes on the root level\n     */\n\n  }, {\n    key: \"hasScopedChildren\",\n    get: function get() {\n      return !this.inlineEditMode;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return EditGridComponent.schema();\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return [];\n    }\n  }, {\n    key: \"editgridKey\",\n    get: function get() {\n      return \"editgrid-\".concat(this.key);\n    }\n  }, {\n    key: \"rowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-row\");\n    }\n  }, {\n    key: \"rowElements\",\n    get: function get() {\n      return this.refs[this.rowRef];\n    }\n  }, {\n    key: \"rowRefs\",\n    get: function get() {\n      return this.refs[\"editgrid-\".concat(this.component.key, \"-row\")];\n    }\n  }, {\n    key: \"addRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-addRow\");\n    }\n  }, {\n    key: \"addRowElements\",\n    get: function get() {\n      return this.refs[this.addRowRef];\n    }\n  }, {\n    key: \"saveRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-saveRow\");\n    }\n  }, {\n    key: \"saveRowElements\",\n    get: function get() {\n      return this.refs[this.saveRowRef];\n    }\n  }, {\n    key: \"cancelRowRef\",\n    get: function get() {\n      return \"\".concat(this.editgridKey, \"-cancelRow\");\n    }\n  }, {\n    key: \"cancelRowElements\",\n    get: function get() {\n      return this.refs[this.cancelRowRef];\n    }\n  }, {\n    key: \"inlineEditMode\",\n    get: function get() {\n      return this.component.inlineEdit;\n    }\n  }, {\n    key: \"saveEditMode\",\n    get: function get() {\n      return !this.inlineEditMode;\n    }\n  }, {\n    key: \"minLength\",\n    get: function get() {\n      return _lodash.default.get(this.component, 'validate.minLength', 0);\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      this._data = value;\n      var data = this.dataValue;\n      (this.editRows || []).forEach(function (row, index) {\n        var rowData = data[index];\n        row.data = rowData;\n        row.components.forEach(function (component) {\n          component.data = rowData;\n        });\n      });\n    }\n  }, {\n    key: \"iteratableRows\",\n    get: function get() {\n      return this.editRows;\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var value = _get(_getPrototypeOf(EditGridComponent.prototype), \"defaultValue\", this);\n\n      var defaultValue = Array.isArray(value) ? value : [];\n\n      _lodash.default.times(this.minLength - defaultValue.length, function () {\n        return defaultValue.push({});\n      });\n\n      return defaultValue;\n    }\n  }, {\n    key: \"loadRefs\",\n    value: function loadRefs(element, refs) {\n      _get(_getPrototypeOf(EditGridComponent.prototype), \"loadRefs\", this).call(this, element, refs);\n\n      var massageContainerRef = 'messageContainer';\n\n      if (refs[\"\".concat(massageContainerRef)] === 'single') {\n        this.refs[\"\".concat(massageContainerRef)] = _toConsumableArray(element.children).filter(function (elem) {\n          var _elem$attributes, _elem$attributes$ref;\n\n          return ((_elem$attributes = elem.attributes) === null || _elem$attributes === void 0 ? void 0 : (_elem$attributes$ref = _elem$attributes.ref) === null || _elem$attributes$ref === void 0 ? void 0 : _elem$attributes$ref.value) === massageContainerRef;\n        })[0];\n      }\n    }\n  }, {\n    key: \"hasRemoveButtons\",\n    value: function hasRemoveButtons() {\n      return !this.component.disableAddingRemovingRows && !this.options.readOnly && !this.disabled && this.fullMode && this.dataValue.length > _lodash.default.get(this.component, 'validate.minLength', 0);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      if (this.builderMode) {\n        this.editRows = [];\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"init\", this).call(this);\n      }\n\n      this.components = this.components || [];\n      var dataValue = this.dataValue || [];\n      var openWhenEmpty = !dataValue.length && this.component.openWhenEmpty;\n\n      if (openWhenEmpty) {\n        var dataObj = {};\n        this.editRows = [];\n        this.createRow(dataObj, 0);\n      } else {\n        this.editRows = dataValue.map(function (row, rowIndex) {\n          return {\n            components: _this2.createRowComponents(row, rowIndex),\n            data: row,\n            state: EditRowState.Saved,\n            backup: null,\n            error: null\n          };\n        });\n      }\n\n      this.prevHasAddButton = this.hasAddButton();\n      this.checkData();\n    }\n  }, {\n    key: \"isOpen\",\n    value: function isOpen(editRow) {\n      return [EditRowState.New, EditRowState.Editing, EditRowState.Viewing].includes(editRow.state);\n    }\n  }, {\n    key: \"isComponentVisibleInSomeRow\",\n    value: function isComponentVisibleInSomeRow(component) {\n      var _this3 = this;\n\n      var rows = this.editRows;\n\n      if (_lodash.default.isEmpty(rows)) {\n        var rowComponents = this.createRowComponents({}, 0);\n        var checkComponent;\n        (0, _utils.eachComponent)(rowComponents, function (comp) {\n          if (comp.component.key === component.key) {\n            checkComponent = comp;\n          }\n\n          comp.checkConditions();\n        });\n        var isVisible = checkComponent ? checkComponent.visible : true;\n\n        _toConsumableArray(this.components).forEach(function (comp) {\n          return _this3.removeComponent(comp, _this3.components);\n        });\n\n        return isVisible;\n      }\n\n      return _lodash.default.some(rows, function (row, index) {\n        var flattenedComponents = _this3.flattenComponents(index);\n\n        var instance = flattenedComponents[component.key];\n        return instance ? instance.visible : true;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render(children) {\n      var _this4 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"render\", this).call(this);\n      }\n\n      var dataValue = this.dataValue || [];\n      var headerTemplate = _utils.Evaluator.noeval ? _templates.default.header : _lodash.default.get(this.component, 'templates.header');\n      var t = this.t.bind(this);\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"render\", this).call(this, children || this.renderTemplate('editgrid', {\n        ref: {\n          row: this.rowRef,\n          addRow: this.addRowRef,\n          saveRow: this.saveRowRef,\n          cancelRow: this.cancelRowRef\n        },\n        header: this.renderString(headerTemplate, {\n          displayValue: function displayValue(component) {\n            return _this4.displayComponentValue(component);\n          },\n          components: this.component.components,\n          value: dataValue,\n          t: t\n        }),\n        footer: this.renderString(_lodash.default.get(this.component, 'templates.footer'), {\n          components: this.component.components,\n          value: dataValue,\n          t: t\n        }),\n        rows: this.editRows.map(this.renderRow.bind(this)),\n        openRows: this.editRows.map(function (row) {\n          return _this4.isOpen(row);\n        }),\n        errors: this.editRows.map(function (row) {\n          return row.error;\n        }),\n        hasAddButton: this.hasAddButton(),\n        hasRemoveButtons: this.hasRemoveButtons()\n      }));\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this$loadRefs,\n          _this5 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"attach\", this).call(this, element);\n      }\n\n      this.loadRefs(element, (_this$loadRefs = {}, _defineProperty(_this$loadRefs, this.addRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.saveRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.cancelRowRef, 'multiple'), _defineProperty(_this$loadRefs, this.rowRef, 'multiple'), _this$loadRefs));\n      this.addRowElements.forEach(function (addButton) {\n        _this5.addEventListener(addButton, 'click', function () {\n          return _this5.addRow();\n        });\n      });\n      var openRowCount = 0;\n      this.rowElements.forEach(function (row, rowIndex) {\n        var _this5$dataValue$rowI;\n\n        var editRow = _this5.editRows[rowIndex];\n\n        if ((_this5$dataValue$rowI = _this5.dataValue[rowIndex]) !== null && _this5$dataValue$rowI !== void 0 && _this5$dataValue$rowI.isRowSelected) {\n          row.classList.add('selected');\n        }\n\n        if (_this5.isOpen(editRow)) {\n          _this5.attachComponents(row, editRow.components);\n\n          _this5.addEventListener(_this5.saveRowElements[openRowCount], 'click', function () {\n            return _this5.saveRow(rowIndex, true);\n          });\n\n          _this5.addEventListener(_this5.cancelRowElements[openRowCount], 'click', function () {\n            return _this5.cancelRow(rowIndex);\n          });\n\n          openRowCount++;\n        } else {\n          // Attach edit and remove button events.\n          [{\n            className: 'removeRow',\n            event: 'click',\n            action: function action() {\n              return _this5.removeRow(rowIndex, true);\n            }\n          }, {\n            className: 'editRow',\n            event: 'click',\n            action: function action() {\n              _this5.editRow(rowIndex).then(function () {\n                if (_this5.component.rowDrafts) {\n                  var _this5$root;\n\n                  _this5.validateRow(editRow, false);\n\n                  var hasErrors = editRow.errors && !!editRow.errors.length;\n                  var shouldShowRowErrorsAlert = _this5.component.modal && hasErrors && ((_this5$root = _this5.root) === null || _this5$root === void 0 ? void 0 : _this5$root.submitted);\n\n                  if (shouldShowRowErrorsAlert) {\n                    _this5.alert.showErrors(editRow.errors, false);\n\n                    editRow.alerts = true;\n                  }\n                }\n              });\n            }\n          }, {\n            className: 'row',\n            event: 'click',\n            action: function action() {\n              row.classList.toggle('selected');\n              var eventName = 'editGridSelectRow';\n\n              if (Array.from(row.classList).includes('selected')) {\n                _this5.dataValue[rowIndex].isRowSelected = true;\n              } else {\n                delete _this5.dataValue[rowIndex].isRowSelected;\n                eventName = 'editGridUnSelectRow';\n              }\n\n              _this5.emit(eventName, {\n                component: _this5.component,\n                data: _this5.dataValue[rowIndex]\n              });\n            }\n          }].forEach(function (_ref) {\n            var className = _ref.className,\n                event = _ref.event,\n                action = _ref.action;\n            var elements = row.getElementsByClassName(className);\n            Array.prototype.forEach.call(elements, function (element) {\n              _this5.addEventListener(element, event, action);\n            });\n          });\n        }\n      }); // Add open class to the element if any edit grid row is open\n\n      if (openRowCount) {\n        this.addClass(this.refs.component, \"formio-component-\".concat(this.component.type, \"-row-open\"));\n      } else {\n        this.removeClass(this.refs.component, \"formio-component-\".concat(this.component.type, \"-row-open\"));\n      }\n\n      return _get(_getPrototypeOf(EditGridComponent.prototype), \"attach\", this).call(this, element);\n    }\n  }, {\n    key: \"flattenRowDataValue\",\n    value: function flattenRowDataValue(dataValue) {\n      var _this6 = this;\n\n      var flattened = {};\n      Object.keys(dataValue).forEach(function (key) {\n        if (_lodash.default.isObject(dataValue[key]) && !_lodash.default.isNil(dataValue[key])) {\n          Object.assign(flattened, _this6.flattenRowDataValue(dataValue[key]));\n        } else {\n          flattened[key] = dataValue[key];\n        }\n      });\n      return flattened;\n    }\n  }, {\n    key: \"isComponentVisibleInRow\",\n    value: function isComponentVisibleInRow(component, flattenedComponents) {\n      var instance = flattenedComponents[component.key];\n      return instance ? instance.visible : true;\n    }\n  }, {\n    key: \"displayComponentValue\",\n    value: function displayComponentValue(component) {\n      return !!((!component.hasOwnProperty('tableView') || component.tableView) && this.isComponentVisibleInSomeRow(component));\n    }\n  }, {\n    key: \"renderRow\",\n    value: function renderRow(row, rowIndex) {\n      var _this7 = this;\n\n      var dataValue = this.dataValue || [];\n\n      if (this.isOpen(row)) {\n        return this.renderComponents(row.components);\n      } else {\n        var flattenedComponents = this.flattenComponents(rowIndex);\n        var rowTemplate = _utils.Evaluator.noeval ? _templates.default.row : _lodash.default.get(this.component, 'templates.row', EditGridComponent.defaultRowTemplate);\n        return this.renderString(rowTemplate, {\n          row: dataValue[rowIndex] || {},\n          data: this.data,\n          rowIndex: rowIndex,\n          components: this.component.components,\n          flattenedComponents: flattenedComponents,\n          displayValue: function displayValue(component) {\n            return _this7.displayComponentValue(component);\n          },\n          isVisibleInRow: function isVisibleInRow(component) {\n            return _this7.isComponentVisibleInRow(component, flattenedComponents);\n          },\n          getView: function getView(component, data) {\n            var _instance$component;\n\n            var instance = flattenedComponents[component.key];\n            var view = instance ? instance.getView(data || instance.dataValue) : ''; // If there is an html tag in view, don't allow it to be injected in template\n\n            var htmlTagRegExp = new RegExp('<(.*?)>');\n            return typeof view === 'string' && view.length && !((_instance$component = instance.component) !== null && _instance$component !== void 0 && _instance$component.template) && htmlTagRegExp.test(view) ? \"<input type=\\\"text\\\" value=\\\"\".concat(view.replace(/\"/g, '&quot;'), \"\\\" readonly/>\") : view;\n          },\n          state: this.editRows[rowIndex].state,\n          t: this.t.bind(this)\n        });\n      }\n    }\n  }, {\n    key: \"eachComponent\",\n    value: function eachComponent(fn, rowIndex) {\n      _lodash.default.each(this.getComponents(rowIndex), function (component, index) {\n        if (fn(component, index) === false) {\n          return false;\n        }\n      });\n    }\n  }, {\n    key: \"restoreComponentsContext\",\n    value: function restoreComponentsContext() {\n      var _this8 = this;\n\n      this.getComponents().forEach(function (component) {\n        var _this8$editRows$compo;\n\n        var rowData = _this8.dataValue[component.rowIndex];\n        var editRowData = (_this8$editRows$compo = _this8.editRows[component.rowIndex]) === null || _this8$editRows$compo === void 0 ? void 0 : _this8$editRows$compo.data;\n        component.data = rowData || editRowData;\n      });\n    }\n  }, {\n    key: \"flattenComponents\",\n    value: function flattenComponents(rowIndex) {\n      var result = {};\n      this.everyComponent(function (component) {\n        result[component.component.flattenAs || component.key] = component;\n      }, rowIndex);\n      return result;\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents(rowIndex) {\n      // Ensure editrows is set.\n      this.editRows = this.editRows || [];\n      return this.builderMode ? _get(_getPrototypeOf(EditGridComponent.prototype), \"getComponents\", this).call(this) : _lodash.default.isNumber(rowIndex) ? this.editRows[rowIndex].components || [] : this.editRows.reduce(function (result, row) {\n        return result.concat(row.components || []);\n      }, []);\n    }\n  }, {\n    key: \"destroyComponents\",\n    value: function destroyComponents(rowIndex) {\n      var _this9 = this;\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(EditGridComponent.prototype), \"destroyComponents\", this).call(this);\n      }\n\n      var components = this.getComponents(rowIndex).slice();\n      components.forEach(function (comp) {\n        return _this9.removeComponent(comp, _this9.components);\n      });\n    }\n  }, {\n    key: \"createRow\",\n    value: function createRow(dataObj, rowIndex) {\n      var editRow = {\n        components: this.createRowComponents(dataObj, rowIndex),\n        data: dataObj,\n        state: EditRowState.New,\n        backup: null,\n        error: null\n      };\n      this.editRows.push(editRow);\n\n      if (this.inlineEditMode) {\n        this.dataValue.push(dataObj);\n      }\n\n      return editRow;\n    }\n  }, {\n    key: \"addRow\",\n    value: function addRow() {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var dataObj = {};\n      var rowIndex = this.editRows.length;\n      var editRow = this.createRow(dataObj, rowIndex);\n\n      if (this.inlineEditMode) {\n        this.triggerChange();\n      }\n\n      this.emit('editGridAddRow', {\n        component: this.component,\n        row: editRow\n      });\n      this.checkRow('checkData', null, {}, editRow.data, editRow.components);\n\n      if (this.component.modal) {\n        this.addRowModal(rowIndex);\n      } else {\n        this.redraw();\n      }\n\n      return editRow;\n    }\n  }, {\n    key: \"addRowModal\",\n    value: function addRowModal(rowIndex) {\n      var _this10 = this;\n\n      var modalContent = this.ce('div');\n      var editRow = this.editRows[rowIndex];\n      editRow.willBeSaved = false;\n      var components = editRow.components;\n      modalContent.innerHTML = this.renderComponents(components);\n      var dialog = this.component.modal ? this.createModal(modalContent, {}, function () {\n        return _this10.showDialog(rowIndex);\n      }) : undefined;\n      dialog.classList.add(\"editgrid-row-modal-\".concat(this.id));\n      editRow.dialog = dialog;\n\n      if (this.alert) {\n        this.alert.clear();\n        this.alert = null;\n      }\n\n      this.alert = new _Alert.default(dialog.refs.dialogContents, this);\n      this.addEventListener(dialog, 'close', function () {\n        if (!editRow.willBeSaved) {\n          _this10.cancelRow(rowIndex);\n        }\n\n        if (_this10.alert) {\n          _this10.alert.clear();\n\n          _this10.alert = null;\n        } // Remove references to dialog elements to prevent possible in some cases memory leaks\n\n\n        delete editRow.confirmationDialog;\n        delete editRow.dialog;\n      });\n      dialog.refs.dialogContents.appendChild(this.ce('button', {\n        class: 'btn btn-primary',\n        onClick: function onClick() {\n          if (_this10.validateRow(editRow, true) || _this10.component.rowDrafts) {\n            editRow.willBeSaved = true;\n            dialog.close();\n\n            _this10.saveRow(rowIndex, true);\n          } else {\n            _this10.alert.showErrors(editRow.errors, false);\n\n            editRow.alerts = true;\n          }\n        }\n      }, this.component.saveRow || 'Save'));\n      return this.attachComponents(modalContent, components);\n    }\n  }, {\n    key: \"showDialog\",\n    value: function showDialog(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n\n      if (_lodash.default.isEqual(editRow.backup, editRow.data)) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      var wrapper = this.ce('div', {\n        ref: 'confirmationDialog'\n      });\n      var dialogContent = this.component.dialogTemplate || this.defaultDialogTemplate;\n      wrapper.innerHTML = dialogContent;\n      wrapper.refs = {};\n      this.loadRefs.call(wrapper, wrapper, {\n        dialogHeader: 'single',\n        dialogCancelButton: 'single',\n        dialogYesButton: 'single'\n      });\n      var dialog = this.createModal(wrapper);\n      dialog.classList.add(\"editgrid-row-modal-confirmation-\".concat(this.id));\n\n      var close = function close(event) {\n        event.preventDefault();\n        dialog.close();\n      };\n\n      var dialogResult;\n      var promise = new _nativePromiseOnly.default(function (resolve, reject) {\n        dialogResult = {\n          resolve: resolve,\n          reject: reject\n        };\n      });\n      this.addEventListener(wrapper.refs.dialogYesButton, 'click', function (event) {\n        close(event);\n        dialogResult.resolve();\n      });\n      this.addEventListener(wrapper.refs.dialogCancelButton, 'click', function (event) {\n        close(event);\n        dialogResult.reject();\n      });\n      editRow.confirmationDialog = dialog;\n      return promise;\n    }\n  }, {\n    key: \"editRow\",\n    value: function editRow(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n      var isAlreadyEditing = editRow.state === EditRowState.Editing || editRow.state === EditRowState.New;\n\n      if (!editRow || isAlreadyEditing) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      editRow.prevState = editRow.state;\n      editRow.state = this.options.readOnly ? EditRowState.Viewing : EditRowState.Editing;\n      var dataSnapshot = (0, _utils.fastCloneDeep)(editRow.data);\n\n      if (this.inlineEditMode) {\n        editRow.backup = dataSnapshot;\n      } else {\n        editRow.backup = (0, _utils.fastCloneDeep)(editRow.data);\n        editRow.data = dataSnapshot;\n        this.restoreRowContext(editRow);\n      }\n\n      if (this.component.modal) {\n        return this.addRowModal(rowIndex);\n      }\n\n      return this.redraw();\n    }\n  }, {\n    key: \"clearErrors\",\n    value: function clearErrors(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n\n      if (editRow && Array.isArray(editRow.components)) {\n        editRow.components.forEach(function (comp) {\n          comp.setPristine(true);\n          comp.setCustomValidity('');\n        });\n      }\n    }\n  }, {\n    key: \"cancelRow\",\n    value: function cancelRow(rowIndex) {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var editRow = this.editRows[rowIndex];\n\n      switch (editRow.state) {\n        case EditRowState.New:\n          {\n            editRow.state = EditRowState.Removed;\n            this.clearErrors(rowIndex);\n            this.destroyComponents(rowIndex);\n\n            if (this.inlineEditMode) {\n              this.splice(rowIndex);\n            }\n\n            this.editRows.splice(rowIndex, 1);\n            break;\n          }\n\n        case EditRowState.Editing:\n          {\n            editRow.state = editRow.prevState;\n\n            if (this.inlineEditMode) {\n              this.dataValue[rowIndex] = editRow.backup;\n            }\n\n            editRow.data = editRow.backup;\n            editRow.backup = null;\n            this.restoreRowContext(editRow);\n\n            if (!this.component.rowDrafts) {\n              this.clearErrors(rowIndex);\n            }\n\n            break;\n          }\n      }\n\n      this.checkValidity(null, true);\n      this.redraw();\n\n      if (this.component.rowDrafts) {\n        this.checkValidity(this.data, false);\n      }\n    }\n  }, {\n    key: \"saveRow\",\n    value: function saveRow(rowIndex, modified) {\n      var _this11 = this;\n\n      var editRow = this.editRows[rowIndex];\n\n      if (this.options.readOnly) {\n        return;\n      }\n\n      var isRowValid = this.validateRow(editRow, true);\n\n      if (!this.component.rowDrafts) {\n        if (!isRowValid) {\n          return false;\n        }\n      }\n\n      if (this.saveEditMode) {\n        var dataValue = this.dataValue || [];\n\n        switch (editRow.state) {\n          case EditRowState.New:\n            {\n              var newIndex = dataValue.length;\n              dataValue.push(editRow.data);\n\n              if (rowIndex !== newIndex) {\n                this.editRows.splice(rowIndex, 1);\n                this.editRows.splice(newIndex, 0, editRow);\n              }\n\n              break;\n            }\n\n          case EditRowState.Editing:\n            {\n              dataValue[rowIndex] = editRow.data;\n              break;\n            }\n        }\n      }\n\n      editRow.state = this.component.rowDrafts && !isRowValid ? EditRowState.Draft : EditRowState.Saved;\n      editRow.backup = null;\n      this.updateValue();\n      this.emit('editGridSaveRow', {\n        component: this.component,\n        row: editRow.data\n      });\n      this.triggerChange({\n        modified: modified,\n        noPristineChangeOnModified: modified && this.component.rowDrafts,\n        isolateRow: true\n      });\n\n      if (this.component.rowDrafts) {\n        editRow.components.forEach(function (comp) {\n          return comp.setPristine(_this11.pristine);\n        });\n      }\n\n      this.checkValidity(null, true);\n      this.redraw();\n\n      if (editRow.alerts) {\n        editRow.alerts = false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"beforeFocus\",\n    value: function beforeFocus(component) {\n      if ('beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n\n      var relativePath = this.getRelativePath(component.path);\n      var arrayPath = (0, _utils.getArrayFromComponentPath)(relativePath);\n\n      if (_lodash.default.isNumber(arrayPath[0])) {\n        this.editRow(arrayPath[0]);\n      }\n    }\n  }, {\n    key: \"updateComponentsRowIndex\",\n    value: function updateComponentsRowIndex(components, rowIndex) {\n      components.forEach(function (component, colIndex) {\n        component.rowIndex = rowIndex;\n        component.row = \"\".concat(rowIndex, \"-\").concat(colIndex);\n      });\n    }\n  }, {\n    key: \"updateRowsComponents\",\n    value: function updateRowsComponents(rowIndex) {\n      var _this12 = this;\n\n      this.editRows.slice(rowIndex).forEach(function (row, index) {\n        _this12.updateComponentsRowIndex(row.components, rowIndex + index);\n      });\n    }\n  }, {\n    key: \"baseRemoveRow\",\n    value: function baseRemoveRow(rowIndex) {\n      var editRow = this.editRows[rowIndex];\n      editRow.state = EditRowState.Removed;\n      this.destroyComponents(rowIndex);\n      return editRow;\n    }\n  }, {\n    key: \"removeRow\",\n    value: function removeRow(rowIndex, modified) {\n      if (this.options.readOnly) {\n        return;\n      }\n\n      this.baseRemoveRow(rowIndex);\n      this.splice(rowIndex);\n      this.emit('editGridDeleteRow', {\n        index: rowIndex\n      });\n      this.editRows.splice(rowIndex, 1);\n      this.updateRowsComponents(rowIndex);\n      this.updateValue();\n      this.triggerChange({\n        modified: modified,\n        noPristineChangeOnModified: modified && this.component.rowDrafts,\n        isolateRow: true\n      });\n      this.checkValidity(null, true);\n      this.checkData();\n      this.redraw();\n    }\n  }, {\n    key: \"createRowComponents\",\n    value: function createRowComponents(row, rowIndex) {\n      var _this13 = this;\n\n      return this.component.components.map(function (col, colIndex) {\n        var column = _lodash.default.clone(col);\n\n        var options = _lodash.default.clone(_this13.options);\n\n        options.name += \"[\".concat(rowIndex, \"]\");\n        options.row = \"\".concat(rowIndex, \"-\").concat(colIndex);\n\n        options.onChange = function () {\n          var _changed$instance$roo, _this13$root;\n\n          var flags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n          var changed = arguments.length > 1 ? arguments[1] : undefined;\n          var modified = arguments.length > 2 ? arguments[2] : undefined;\n\n          if ((_changed$instance$roo = changed.instance.root) !== null && _changed$instance$roo !== void 0 && _changed$instance$roo.id && ((_this13$root = _this13.root) === null || _this13$root === void 0 ? void 0 : _this13$root.id) !== changed.instance.root.id) {\n            changed.instance.root.triggerChange(_objectSpread(_objectSpread({}, flags), {}, {\n              noValidate: true\n            }), changed, modified);\n          } else {\n            _this13.triggerRootChange(_objectSpread(_objectSpread({}, flags), {}, {\n              noValidate: true\n            }), changed, modified);\n          }\n\n          if (_this13.inlineEditMode) {\n            return;\n          }\n\n          var editRow = _this13.editRows[rowIndex];\n\n          if (editRow !== null && editRow !== void 0 && editRow.alerts) {\n            _this13.checkData(null, _objectSpread(_objectSpread({}, flags), {}, {\n              changed: changed,\n              rowIndex: rowIndex\n            }), _this13.data);\n          } else if (editRow) {\n            // If drafts allowed, perform validation silently if there was no attempt to submit a form\n            var silentCheck = _this13.component.rowDrafts && !_this13.shouldValidateDraft(editRow);\n\n            _this13.checkRow('checkData', null, _objectSpread(_objectSpread({}, flags), {}, {\n              changed: changed,\n              silentCheck: silentCheck\n            }), editRow.data, editRow.components, silentCheck);\n          }\n        };\n\n        var comp = _this13.createComponent(_lodash.default.assign({}, column, {\n          row: options.row\n        }), options, row);\n\n        comp.rowIndex = rowIndex;\n        comp.inEditGrid = true;\n        return comp;\n      });\n    }\n  }, {\n    key: \"hasOpenRows\",\n    value: function hasOpenRows() {\n      var _this14 = this;\n\n      return this.editRows.some(function (row) {\n        return _this14.isOpen(row);\n      });\n    }\n  }, {\n    key: \"shouldValidateDraft\",\n    value: function shouldValidateDraft(editRow) {\n      var _this$root, _this$root2;\n\n      // Draft rows should be validated only when there was an attempt to submit a form\n      return editRow.state === EditRowState.Draft && !this.pristine && !((_this$root = this.root) !== null && _this$root !== void 0 && _this$root.pristine) && !this.hasOpenRows() || ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : _this$root2.submitted);\n    }\n  }, {\n    key: \"shouldValidateRow\",\n    value: function shouldValidateRow(editRow, dirty) {\n      return this.shouldValidateDraft(editRow) || editRow.state === EditRowState.Editing || dirty;\n    }\n  }, {\n    key: \"validateRow\",\n    value: function validateRow(editRow, dirty) {\n      var _this15 = this,\n          _this$root3;\n\n      var valid = true;\n\n      var errorsSnapshot = _toConsumableArray(this.errors);\n\n      if (this.shouldValidateRow(editRow, dirty)) {\n        editRow.components.forEach(function (comp) {\n          if (!_this15.component.rowDrafts) {\n            comp.setPristine(!dirty);\n          }\n\n          var silentCheck = _this15.component.rowDrafts && !_this15.shouldValidateDraft(editRow);\n          valid &= comp.checkValidity(null, dirty, editRow.data, silentCheck);\n        });\n      }\n\n      if (this.component.validate && this.component.validate.row) {\n        valid = this.evaluate(this.component.validate.row, {\n          valid: valid,\n          row: editRow.data\n        }, 'valid', true);\n\n        if (valid.toString() !== 'true') {\n          editRow.error = valid;\n          valid = false;\n        } else {\n          editRow.error = null;\n        }\n\n        if (valid === null) {\n          valid = \"Invalid row validation for \".concat(this.key);\n        }\n      }\n\n      editRow.errors = !valid ? this.errors.filter(function (err) {\n        return !errorsSnapshot.includes(err);\n      }) : null;\n\n      if (!this.component.rowDrafts || (_this$root3 = this.root) !== null && _this$root3 !== void 0 && _this$root3.submitted) {\n        this.showRowErrorAlerts(editRow, !!valid);\n      }\n\n      return !!valid;\n    }\n  }, {\n    key: \"showRowErrorAlerts\",\n    value: function showRowErrorAlerts(editRow, valid) {\n      if (editRow.alerts) {\n        if (this.alert) {\n          var _editRow$errors;\n\n          if ((_editRow$errors = editRow.errors) !== null && _editRow$errors !== void 0 && _editRow$errors.length && !valid) {\n            this.alert.showErrors(editRow.errors, false);\n            editRow.alerts = true;\n          } else {\n            this.alert.clear();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      data = data || this.rootValue;\n      row = row || this.data;\n\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      return this.checkComponentValidity(data, dirty, row, {\n        silentCheck: silentCheck\n      });\n    }\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row, options) {\n      var _this16 = this;\n\n      var superValid = _get(_getPrototypeOf(EditGridComponent.prototype), \"checkComponentValidity\", this).call(this, data, dirty, row, options); // If super tells us that component invalid and there is no need to update alerts, just return false\n\n\n      if (!superValid && (!this.alert || !this.hasOpenRows())) {\n        return false;\n      }\n\n      if (this.shouldSkipValidation(data, dirty, row)) {\n        return true;\n      }\n\n      var rowsValid = true;\n      var rowsEditing = false;\n      this.editRows.forEach(function (editRow, index) {\n        // Trigger all errors on the row.\n        var rowValid = _this16.validateRow(editRow, editRow.alerts || dirty);\n\n        rowsValid &= rowValid;\n\n        if (_this16.rowRefs) {\n          var rowContainer = _this16.rowRefs[index];\n\n          if (rowContainer) {\n            var errorContainer = rowContainer.querySelector('.editgrid-row-error');\n\n            if (!rowValid && errorContainer) {\n              errorContainer.textContent = _this16.t('invalidRowError');\n            }\n          }\n        } // If this is a dirty check, and any rows are still editing, we need to throw validation error.\n\n\n        rowsEditing |= dirty && _this16.isOpen(editRow);\n      });\n\n      if (!rowsValid) {\n        this.setCustomValidity(this.t('invalidRowsError'), dirty);\n        return false;\n      } else if (rowsEditing && this.saveEditMode) {\n        this.setCustomValidity(this.t('unsavedRowsError'), dirty);\n        return false;\n      }\n\n      var message = this.invalid || this.invalidMessage(data, dirty);\n      this.setCustomValidity(message, dirty);\n      return superValid;\n    }\n  }, {\n    key: \"changeState\",\n    value: function changeState(changed, flags) {\n      if (changed || flags.resetValue && this.component.modalEdit) {\n        this.rebuild();\n      } else {\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this17 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!value) {\n        value = this.defaultValue;\n      }\n\n      if (!Array.isArray(value)) {\n        if (_typeof(value) === 'object') {\n          value = [value];\n        } else {\n          return false;\n        }\n      }\n\n      var changed = this.hasChanged(value, this.dataValue);\n      this.dataValue = value; // Refresh editRow data when data changes.\n\n      this.dataValue.forEach(function (row, rowIndex) {\n        var editRow = _this17.editRows[rowIndex];\n\n        if (editRow) {\n          editRow.data = row;\n\n          _this17.restoreRowContext(editRow, flags);\n\n          editRow.state = EditRowState.Saved;\n          editRow.backup = null;\n          editRow.error = null;\n        } else {\n          _this17.editRows[rowIndex] = {\n            components: _this17.createRowComponents(row, rowIndex),\n            data: row,\n            state: EditRowState.Saved,\n            backup: null,\n            error: null\n          };\n        }\n      });\n      var dataLength = this.dataValue.length; // If the last row is a new row, then do not remove it.\n\n      if (this.editRows[dataLength] && this.editRows[dataLength].state === EditRowState.New) {\n        dataLength = dataLength + 1;\n      }\n\n      this.editRows.slice(dataLength).forEach(function (editRow, index) {\n        return _this17.baseRemoveRow(dataLength + index);\n      });\n      this.editRows = this.editRows.slice(0, dataLength);\n      var shouldBeOpened = !this.dataValue.length && this.component.openWhenEmpty;\n      var hasNoRows = !this.editRows.length;\n\n      if (hasNoRows && shouldBeOpened && !this.builderMode) {\n        var dataObj = {};\n        this.createRow(dataObj, 0);\n      }\n\n      this.updateOnChange(flags, changed);\n      this.checkData();\n      this.changeState(changed, flags);\n      return changed;\n    }\n  }, {\n    key: \"restoreRowContext\",\n    value: function restoreRowContext(editRow) {\n      var _this18 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      editRow.components.forEach(function (component) {\n        component.data = editRow.data;\n\n        _this18.setNestedValue(component, editRow.data, flags);\n      });\n    }\n  }, {\n    key: \"emptyRows\",\n    value: function emptyRows() {\n      var _this19 = this;\n\n      this.editRows.forEach(function (editRow, index) {\n        return _this19.destroyComponents(index);\n      });\n      this.editRows = [];\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _get(_getPrototypeOf(EditGridComponent.prototype), \"resetValue\", this).call(this);\n\n      this.emptyRows();\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _NestedArrayComponent2.default.schema.apply(_NestedArrayComponent2.default, [{\n        type: 'editgrid',\n        label: 'Edit Grid',\n        key: 'editGrid',\n        clearOnHide: true,\n        input: true,\n        tree: true,\n        removeRow: 'Cancel',\n        defaultOpen: false,\n        openWhenEmpty: false,\n        modal: false,\n        components: [],\n        inlineEdit: false,\n        templates: {\n          header: EditGridComponent.defaultHeaderTemplate,\n          row: EditGridComponent.defaultRowTemplate,\n          footer: ''\n        }\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Edit Grid',\n        icon: 'tasks',\n        group: 'data',\n        documentation: '/userguide/#editgrid',\n        weight: 30,\n        schema: EditGridComponent.schema()\n      };\n    }\n  }, {\n    key: \"defaultHeaderTemplate\",\n    get: function get() {\n      return \"<div class=\\\"row\\\">\\n      {% util.eachComponent(components, function(component) { %}\\n        {% if (displayValue(component)) { %}\\n          <div class=\\\"col-sm-2\\\">{{ t(component.label) }}</div>\\n        {% } %}\\n      {% }) %}\\n    </div>\";\n    }\n  }, {\n    key: \"defaultRowTemplate\",\n    get: function get() {\n      return \"<div class=\\\"row\\\">\\n      {% util.eachComponent(components, function(component) { %}\\n        {% if (displayValue(component)) { %}\\n          <div class=\\\"col-sm-2\\\">\\n            {{ isVisibleInRow(component) ? getView(component, row[component.key]) : ''}}\\n          </div>\\n        {% } %}\\n      {% }) %}\\n      {% if (!instance.options.readOnly && !instance.disabled) { %}\\n        <div class=\\\"col-sm-2\\\">\\n          <div class=\\\"btn-group pull-right\\\">\\n            <button class=\\\"btn btn-default btn-light btn-sm editRow\\\"><i class=\\\"{{ iconClass('edit') }}\\\"></i></button>\\n            {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\\n              <button class=\\\"btn btn-danger btn-sm removeRow\\\"><i class=\\\"{{ iconClass('trash') }}\\\"></i></button>\\n            {% } %}\\n          </div>\\n        </div>\\n      {% } %}\\n    </div>\";\n    }\n  }]);\n\n  return EditGridComponent;\n}(_NestedArrayComponent2.default);\n\nexports.default = EditGridComponent;\nEditGridComponent.prototype.hasChanged = _Component.default.prototype.hasChanged;"]},"metadata":{},"sourceType":"script"}